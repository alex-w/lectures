\documentclass[10pt,pdf,hyperref={unicode}]{beamer}
\hypersetup{pdfpagemode=FullScreen}
\usepackage{ed}
\usepackage{lect}

\title[Компьютерная обработка. Лекции 3, 4.]{Компьютерная обработка результатов измерений}
\subtitle{Лекция 3. Теория физических измерений. Систематические и случайные погрешности.\\
Лекция 4. Теория оценок.}
\date{22 марта 2021 года}

\begin{document}
% Титул
\begin{frame}
\maketitle
\end{frame}
% Содержание
\begin{frame}
\tableofcontents
\end{frame}

\section{Измерения и величины}
\begin{frame}{Измерения и величины}
\begin{defin}
\ж Мерой\н называется средство измерений, предназначенное для воспроизведения и хранения значения
физической величины.
Результатом сравнения оцениваемой вещи с мерой является именованное число,
называемое\ж значением величины\н.
\end{defin}
\begin{block}{Физические величины}
\begin{itemize}
\item постоянные (инварианты, константы, априорно фиксированные значения);
\item изменяющиеся (по определенному закону от $t$);
\item случайные (не имеющие точного значения).
\end{itemize}
Единицы измерения, размерность.\par
Скалярные, векторные, комплексные, тензорные величины.\par
Метрология.
\end{block}
\end{frame}

\begin{frame}{Виды измерений}
\begin{description}
\only<1>{
\item[Прямое] при котором искомое значение физической величины получают непосредственно.
\item[Косвенное] на основании результатов прямых измерений других физических величин,
функционально связанных с искомой величиной.
\item[Совместные] проводимые одновременно для нескольких неодноименных величин для определения
зависимости  между ними.
\item[Совокупные] при которых искомые значения величин определяют путем решения системы уравнений,
получаемых при измерениях этих величин в различных сочетаниях.
\item[Равноточные] выполненные  одинаковыми по точности средствами измерений.
\item[Неравноточные] выполненных различающимися по точности средствами измерений и (или) в разных
условиях.}
\only<2>{
\item[Однократное, многократное]
\item[Статическое] для  величины, принимаемой в соответствии с конкретной  измерительной задачей за
неизменную на протяжении времени измерения.
\item[Динамическое] для  изменяющейся по размеру физической величины.
\item[Абсолютное]  основанное на прямых измерениях одной или нескольких основных
величин и (или) использовании значений физических констант.
\item[Относительное] сравнение с эталонными мерами.}
\end{description}
\end{frame}


\begin{frame}{Представление результатов измерений}
\begin{columns}\column{0.5\textwidth}
Графическое
\img[0.7]{graph_res}
\column{0.5\textwidth}
Табличное
\img{tab_res}
\end{columns}
\end{frame}

\section{Погрешность}
\begin{frame}{Погрешность}
\only<1>{
\begin{defin}
\ж Погрешность\н --- отклонение измеренного значения величины от её истинного (действительного)
значения.
\end{defin}
\begin{block}{}
Абсолютная погрешность, $\Delta x$ (напр., RMS); относительная погрешность, $\delta x=\Delta
x/\mean{x}$; приведенная погрешность $\gamma x=\Delta x/N_x$ (нормировочный коэффициент).
\end{block}
\begin{block}{По причине возникновения}
\begin{description}
\item[Инструментальные] определяются погрешностями применяемых средств измерений.
\item[Методические] обусловлены  несовершенством метода, а также упрощениями, положенными в основу
методики.
\item[Субъективные] обусловлены качествами экспериментатора.
\end{description}
\end{block}}
\only<2>{
\begin{block}{По характеру проявления}
\begin{description}
\item[Случайные] обусловлены совокупностью внешних факторов, влияющих на результат эксперимента.
\item[Систематические] связаны с влиянием прибора на измеряемую величину или методическими
ошибками, выявляются лишь сменой прибора\slash метода\slash экспериментатора.
\item[Промахи] наиболее сильно себя проявляют и связаны с неисправностью прибора или
экспериментатора.
\end{description}
\end{block}
\begin{block}{Средняя квадратическая погрешность среднего арифметического}
$$
\sigma_{\aver{x}}=\frac{\sigma_x}{\sqrt{n}}=
\sqrt{\frac{\sum\limits_{i=1}^n(\mean{x_i}-\aver{x})^2}{n(n-1)}}.
$$
\end{block}
}
\end{frame}

\begin{frame}{Доверительный интервал}
\only<1>{\begin{columns}\column{0.6\textwidth}
\begin{block}{Доверительная вероятность}
$p = P(X_0 \le x \le X_1)$
\end{block}
\begin{block}{Математическое ожидание}
Если известен закон распределения (мат. ожидание и дисперсия: $\mu$ и $\sigma$), то
$$P\Bigl(\aver{X}-z_{1-\frac{\alpha}2}\frac{\sigma}{\sqrt{n}} \le \mu \le
	\aver{X}+z_{1-\frac{\alpha}2}\frac{\sigma}{\sqrt{n}}\Bigr) = 1 - \alpha,$$
где $z_\alpha$~-- $\alpha$--квантиль нормального распределения
\end{block}
\column{0.4\textwidth}
\img{Boxplot_vs_PDF}
Квартили: первый (0.25-квантиль), второй (0.5-квантиль, медиана) и третий (0.75-квантиль).
\end{columns}
}
\only<2>{
    \begin{defin}\ж $\alpha$--квантилем\н называется число $x_\alpha$:
        $P(X\le x_\alpha)\ge\alpha$ и $P(X\ge x_\alpha)\ge1-\alpha$. Т.е. по интегральной функции распределения
        $F(x_\alpha)=\alpha$. А т.к. $P(a\le X\le b)=F(b)-F(a)$, получаем:
        $$P(x_{1-\frac{\alpha}2}\le X\le x_{1+\frac{\alpha}2})=\alpha.$$
    \end{defin}
\begin{block}{Пример}
В 64 наблюдениях получено: $S_1=\sum x=600$, $S_2=\sum (x-\mean{x})^2=3800$. Вычислить 90\% доверительный
интервал
матожидания.

Решение: $\sigma=\sqrt{S_2/(n-1)}=7.72$; $\aver{x}=S_1/n=9.375$. $F(0.05)=1.96$, отсюда найдем границы интервала
$\aver{x}\pm F(0.05)\sigma/\sqrt{n}$:
$\mean{x}\in[7.484, 11.266]$ с точностью 90\%.
\end{block}
}
\only<3>{
\begin{block}{Математическое ожидание}
Если закон распределения неизвестен, то
$$P\Bigl(\mean{X}-t_{1-\frac{\alpha}2, n-1}\frac{S}{\sqrt{n}} \le \mu \le
	\mean{X}+t_{1-\frac{\alpha}2,n-1}\frac{S}{\sqrt{n}}\Bigr) = 1 - \alpha,$$
где $S$~-- несмещенный RMS. Величина
$$T=\frac{\mean{X}-\mu}{S/\sqrt{n}}$$ имеет распределение Стьюдента, а $t_{\alpha, n-1}$~-- его
квантили.

Пример: $\mean{X}=10$, $S_n=2$, $n=11$ (10~степеней свободы), по таблице для двухстороннего
распределения Стьюдента с вероятностью~95\% $T_{10}^{95}=2.228$. Тогда доверительный интервал есть
$\mean{X}\pm TS_n/\sqrt{n}$, т.е. $\mu\in(8.6565, 11.3440)$.
\end{block}
}
\only<4>{
\begin{block}{Дисперсия}
Если известно среднее, можно воспользоваться распределением $\chi^2$.
$$
P\Biggl(\frac{\displaystyle\sum_{i=1}^n (X_i-\mu)^2}{\chi^2_{(1+\alpha)/2,n}}\le\sigma^2\le
\frac{\displaystyle\sum_{i=1}^n (X_i-\mu)^2}{\chi^2_{(1-\alpha)/2,n}}\Biggr)=\alpha.
$$
Если же среднее неизвестно, то
$$
P\Bigl(\frac{(n-1)S^2}{\chi^2_{(1+\alpha)/2,n-1}}\le\sigma^2\le
\frac{(n-1)S^2}{\chi^2_{(1-\alpha)/2,n-1}}\Bigr)=\alpha.
$$
\end{block}
}
\end{frame}

\begin{frame}{Правила вычисления погрешностей}
\begin{block}{}
\begin{enumerate}
\item
$$\Delta\bigl(\sum a_n\bigr)=\sum\Delta a_n.$$
\item
$$\prod(a_i\pm\Delta a_i)=\prod a_i\prod(1\pm\delta a_i)\approx
\prod a_i(1\pm\sum\delta a_i),$$
$$\bigl(a[1\pm\delta a]\bigr)^n\approx a^n(1\pm n\delta a).$$
\item\ж В сложных функциях\н вида $y=f(x_1,\ldots,x_n)$ можно оценить
погрешность, воспользовавшись приближением:
$$
\delta y\approx\Bigl|\frac{dy}{y}\Bigr|=\Bigl|
\frac{d f(x_1,\ldots,x_n)}{f(x_1,\ldots,x_n)}\Bigr|,
$$
в котором следует заменить $\frc{dx_i}{x_i}=\delta x_i$~-- относительная
погрешность
измерения величины~$x_i$, $d x_i=\Delta x_i$~-- абсолютная погрешность. Все
слагаемые необходимо суммировать по абсолютной величине.
\end{enumerate}
\end{block}
\end{frame}

\section{Метод наименьших квадратов}
\begin{frame}{Метод наименьших квадратов}
\begin{block}{}
Пусть имеется функция $f(x|a)$, зависящая от аргумента $x$ и набора параметров~$a$. Данной функции
соответствует набор пар данных $(x_n,y_n)$, причем $y_n=f(x_n|a)+\epsilon_n$, где $\epsilon_n$~--
случайная ошибка. Математическое ожидание ошибки $\mean{\epsilon}=0$, ее среднеквадратическое
отклонение равно~$\sigma_n$. Для оценки~$a$ (аппроксимации набора данных заданной функцией)
необходимо минимизировать выражение
$$\Phi=\sum_{n=1}^N\Bigl(\frac{y_n-f(x_n|a)}{\sigma^2_n}\Bigr)^2.$$
При этом подразумевается, что  число измерений превышает число параметров~$a$.
\end{block}
\end{frame}

\begin{frame}{Пример: линейная зависимость}
\begin{block}{}
Пусть $y=ax+b$, $x_n$ известны с пренебрежимо малой погрешностью, $y_n$~-- результаты измерений
с нормальным распределением, $\mean{y_i}=ax_i+b$. Минимизируем величину $Y=\sum(y_i-\mean{y_i})^2$,
$\partder{Y}{a}=0$, $\partder{Y}{b}=0$:
$$
a=\frac{n\sum x_iy_i-\sum x_i\sum y_i}{n\sum x^2_i-\Bigl(\sum x_i\Bigr)^2}=
\frac{\mean{xy}-\mean{x}\,\mean{y}}{\mean{x^2}-(\mean{x})^2},
$$
$$
b=\frac{\sum x_i^2\sum y_i-\sum x_i\sum x_i y_i}{n\sum x^2_i-\Bigl(\sum
x_i\Bigr)^2}=
\frac{\mean{x^2\strut}\,\mean{\strut
y}-\mean{x}\,\mean{xy}}{\mean{x^2}-(\mean{x})^2}.
$$
$$
\sigma^2=\frac{n}{n-2}\Bigl(\mean{y^2}-(\mean{y})^2-a^2\bigl[
\mean{x^2}-(\mean{x})^2\bigr]\Bigr),\qquad
\sigma^2_a=\frac{\sigma^2}{n\bigl(\mean{x^2}-(\mean{x})^2\bigr)},\quad
\sigma_b^2=\sigma_a^2\mean{x^2}.
$$
\end{block}
\end{frame}

\begin{frame}{Аппроксимация МНК}
\only<1>{\img{lesssquare}}
\only<2>{
\begin{block}{}
Некоторые зависимости, можно свести к линейным. Например, $y=\e^{ax+b}$ \so $\ln y=ax+b$.

Возможно также сведение зависимостей к системам линейных уравнений $A\vec{x}=\vec{b}$, ранг матрицы
$A$ должен быть больше количества искомых переменных. Минимизируем
$(A\vec{x}-\vec{b})^T(A\vec{x}-\vec{b})$, что приводит к системе уравнений
$$
A^TA\vec{x}=A^T\vec{b}\quad\so\quad
\vec{x}=(A^TA)^{-1}A^T\vec{b}.
$$
Или $\vec{x}=A^{+}\vec{b}$ (псевдообратная матрица), в Octave~--- <<левое деление>> $A\backslash
b$.
\end{block}
}
\end{frame}

\begin{frame}[fragile]{}
\begin{block}{Пример}
Пусть заведомо величина изменяется по закону $y=a_0+a_1\e^{-t}+a_2te^{-t}$.
В матричном виде $Y=TA$, где $T$~-- функциональная матрица, у которой в первом столбце
размещены единицы (соответствует умножению на~$a_0$), во втором~--- функция
$\e^{-t}$, а в третьем~--- $t\e^{-t}$. Коэффициенты~$A$ найдем при помощи МНК:
$A=T\backslash Y$.
\begin{verbatim}
t = [0 0.3 0.8 1.1 1.6 2.3]';
y = [0.6 0.67 1.01 1.35 1.47 1.25]';
T = [ones(size(t))  exp(-t)  t.*exp(-t)];
A = T\y
\end{verbatim}

\end{block}

\end{frame}

\section{Правило <<трех сигм>>}
\begin{frame}{Правило <<трех сигм>>}
\begin{block}{}
При гауссовом распределении случайной величины вероятность
$$P(|x-\mean{x}|<3\sigma)=2\Phi(3)=0.9973.$$
($\Phi$~-- нормальное интегральное распределение).
\end{block}
\begin{defin}
\ж Правило трех сигм\н: если случайная величина распределена нормально, то абсолютная величина ее
отклонения от математического ожидания не превосходит утроенного среднего квадратичного отклонения.
\end{defin}
\begin{defin}
\ж Теорема Ляпунова\н: случайная величина, являющаяся суммой большого числа взаимно независимых
случайных величин, имеет нормальное распределение.
\end{defin}
\end{frame}

\section{Иррегулярно распределенные данные}
\begin{frame}{}
\begin{columns}
\column{0.65\textwidth}
\begin{block}{Иррегулярно распределенные данные}
БПФ, корреляция, периодограммы и т.п.
\begin{itemize}
\item Resampling (если данные достаточно плотно расположены).
\item Определение периода как расстояния между минимумами (максимумами) из аппроксимации.
\item Auto Regressive Moving Average (ARMA).
\item Фильтрация Калмана.
\item Метод Ваничека (аппроксимация набора данных рядом синусоид).
\item Периодограмма Ломба-Скаргла (ортогонализация пар синусоид введением задержки во времени,
Scargle, 1981).
\item Irregular Autoregressive Model (IAR).
\item Complex IAR (CIAR).
\end{itemize}
\end{block}
\column{0.32\textwidth}
\vspace*{-2em}\img{irregular}
\end{columns}
\end{frame}

\begin{frame}{Спасибо за внимание!}
\centering
\begin{minipage}{5cm}
\begin{block}{mailto}
eddy@sao.ru\\
edward.emelianoff@gmail.com
\end{block}\end{minipage}
\end{frame}
\end{document}
